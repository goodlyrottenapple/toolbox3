infixl 1 &&
infix 2 âŠ¢ , âˆˆ , ++, â‰¡
infix 3 \\ , \
infixr 3 â†’ , -< , >, âˆ·, $
infixl 4 âˆ§, âˆ¨, ;, âˆª, âˆ©


language LaTeX



data [SMT] F : * where
    At : (atom : Name) -> F
  | (âˆ§) [andF] : (andL:F) -> (andR:F) -> F
  | (âˆ¨) [orF] : (orL:F) -> (orR:F) -> F
  | (â†’) [impF] : (impL:F) -> (impR:F) -> F
  | Â¬ [negF] : (neg:F) -> F
end

translation F to LaTeX where
    At a -> "#{a}"
  | (âˆ§) a b -> "#{a} \wedge #{b}"
  | (âˆ¨) a b -> "#{a} \vee #{b}"
  | (â†’) a b -> "#{a} \to #{b}"
  | Â¬ a -> "\neg #{a}"
end


data [SMT] List : Type -> * where
    âˆ… [nil] : {a : Type} -> List a
  | (âˆ·) [cons] : {a : Type} -> (hd : a) -> (tl : List a) -> List a
end


data [SMT] Pair : Type -> Type -> * where
    MkPair : {a : Type} -> {b : Type} -> (fst:a) -> (snd:b) -> Pair a b
end

prop (â‰¡) : {a : Type} -> (x : a) -> (y : a) -> Prop where 
  ('= x y)
end

smt
(define-fun-rec concatF ((x (List F)) (y (List F))) (List F)
 (ite (= x (as nil (List F)))
      y
      (cons (hd x) (concatF (tl x) y))
 )
)
end

prop (++) : {a : Type} -> (x : List F) -> (y : List F) -> List F where 
  ('concatF x y)
end

data (âŠ¢) : List F -> List F -> Type where
    Id : {a : Name} -> (At a) âˆ· âˆ… âŠ¢ (At a) âˆ· âˆ…
  | AndL1 : {Î“ : List F} -> {Î” : List F} -> {A : F} -> {B : F} ->
         A âˆ· Î“ âŠ¢ Î” ->
      ---------------
      (A âˆ§ B) âˆ· Î“ âŠ¢ Î”
  | AndL2 : {Î“ : List F} -> {Î” : List F} -> {A : F} -> {B : F} ->
         B âˆ· Î“ âŠ¢ Î” ->
      ---------------
      (A âˆ§ B) âˆ· Î“ âŠ¢ Î”
  | OrL : {Î“â‚ : List F} -> {Î“â‚‚ : List F} -> 
          {Î”â‚ : List F} -> {Î”â‚‚ : List F} -> 
          {Î“ : List F} -> [Î“ â‰¡ (Î“â‚ ++ Î“â‚‚)] -> 
          {Î” : List F} -> 
          {A : F} -> {B : F} ->
      (A âˆ· Î“â‚) âŠ¢ Î”â‚ -> (B âˆ· Î“â‚‚) âŠ¢ Î”â‚‚ -> 
      ------------------------------
              (A âˆ¨ B) âˆ· Î“ âŠ¢ Î”
end




-- def test : ((At 'a) âˆ¨ (At 'b)) âˆ· âˆ… âŠ¢ ((At 'a) âˆ¨ (At 'b)) âˆ· âˆ… where
--   test = OrL ? ?
-- end



--   IdIR    : {r : Name} -> {ð“ : Set Name} -> {ts : List ð“ Trm} -> 

--             --------------------
--             IR r ts âŠ¢ â†‘ (R r ts) 
--   |
--   AllR    : {ð“â‚“ : Set Name} -> {ð“â‚ : Set Name} -> 
--             {X : S ð“â‚“} -> {x : Name} -> {A : F ð“â‚} -> 

--           X âŠ¢ Q x (â†‘ A) ->
--           -------------
--           X âŠ¢ â†‘ (âˆ€ x A)
--   | 
--   QâŠ™Disp  : {ð“â‚“ : Set Name} -> {ð“áµ§ : Set Name} -> 
--             {X : S ð“â‚“} -> {Y : S ð“áµ§} -> {x : Name} ->

--             Y âŠ¢ Q x X ->
--             ---------
--             âŠ™ x Y âŠ¢ X
--   | 
--   QâŠ™Disp2 : {ð“â‚“ : Set Name} -> {ð“áµ§ : Set Name} -> 
--             {X : S ð“â‚“} -> {Y : S ð“áµ§} -> {x : Name} ->

--             (âŠ™ x Y) âŠ¢ X ->
--             -----------
--             Y âŠ¢ (Q x X)
--   | 
--   âˆ˜R :     {ð“â‚“ : Set Name} -> {ð“â‚ : Set Name} -> 
--          {X : S ð“â‚“} -> {x : Name} -> {A : F ð“â‚} -> 

--            X âŠ¢ âŠ™ x (â†‘ A) ->
--            -------------
--            X âŠ¢ â†‘ (âˆ˜ x A)
--   | 
--   âŠ™mon :   {ð“ : Set Name} -> {ð“â‚‚ : Set Name} -> 
--            {X : S ð“} -> {Y : S ð“} -> {x : Name} ->

--                   X âŠ¢ Y -> 
--          -----------------------
--          âŠ™ {ð“} {ð“â‚‚} x X âŠ¢ âŠ™ x Y
--   | 
--   IRL :    {r : Name} -> {ð“ : Set Name} -> 
--            {X : S ð“} -> {ts : List ð“ Trm} -> 

--          IR r ts âŠ¢ X ->
--          --------------
--          â†‘ (R r ts) âŠ¢ X
-- end


-- translation (âŠ¢) to LaTeX where
--     IdIR : x âŠ¢ y -> "\AXC{}\RightLabel{$\sub{Id}{\mathbb{I}R}$}\n\UIC{$#{x} \vdash #{y}$}"
--   | AllR p : x âŠ¢ y -> "#{p}\RightLabel{$\sub{\forall}{R}$}\n\UIC{$#{x} \vdash #{y}$}"
--   | QâŠ™Disp2 p : x âŠ¢ y -> "#{p}\RightLabel{(Q/âŠ™)}\n\UIC{$#{x} \vdash #{y}$}"
--   | âˆ˜R p : x âŠ¢ y -> "#{p}\RightLabel{$\sub{âˆ˜}{R}$}\n\UIC{$#{x} \vdash #{y}$}"
--   | âŠ™mon p : x âŠ¢ y -> "#{p}\RightLabel{âŠ™mon}\n\UIC{$#{x} \vdash #{y}$}"
--   | IRL p : x âŠ¢ y -> "#{p}\RightLabel{$\sub{\mathbb{I} R}{L}$}\n\UIC{$#{x} \vdash #{y}$}"
-- end


-- def lemma : â†‘(R 'f âˆ…) âŠ¢ â†‘(âˆ€ 'x (âˆ˜ 'x (R 'f âˆ…))) where
--     lemma = (AllR (QâŠ™Disp2 (âˆ˜R (âŠ™mon (IRL IdIR)))))
-- end

-- translate lemma to LaTeX where
--   output = "./out.tex"
-- end